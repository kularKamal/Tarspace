version: 1
project: CI-WEB-INTERFACE@IOTINGA
remote_url: https://github.com/iotinga/iotinga-delivery-web-app

prepare:
  - version
  - shell: npm version {{ env.run.version }}
  - shell: git commit -a -m '[CI] bump version to {{ env.run.version }}'
  - shell: git push
    continue-on-error: true

artifacts:
  - name: iotinga-delivery-web-app
    build:
      - shell: npm ci && npm test && npm run build
      - upload:
          preserve-path: true
          sources: build/**/*

deliverables:
  - name: iotinga-delivery-web-app
    artifacts:
      - iotinga-delivery-web-app
    publish:
      - shell: aws s3 sync build/ s3://space-tinga-io
